(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,o,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(3798)}])},3798:function(e,o,n){"use strict";function t(e,o,n){return o in e?Object.defineProperty(e,o,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[o]=n,e}function r(e){for(var o=1;o<arguments.length;o++){var n=null!=arguments[o]?arguments[o]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(o){t(e,o,n[o])}))}return e}n.r(o),n.d(o,{default:function(){return p}});var i=n(5893),u=n(7294);function a(e,o,n,t,r,i,u){try{var a=e[i](u),l=a.value}catch(c){return void n(c)}a.done?o(l):Promise.resolve(l).then(t,r)}function l(e){return function(){var o=this,n=arguments;return new Promise((function(t,r){var i=e.apply(o,n);function u(e){a(i,t,r,u,l,"next",e)}function l(e){a(i,t,r,u,l,"throw",e)}u(void 0)}))}}function c(e,o){return o=null!=o?o:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):function(e,o){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);o&&(t=t.filter((function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable}))),n.push.apply(n,t)}return n}(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))})),e}var s=n(655),f=function(){function e(o){var n=o.playOptions;!function(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}(this,e),console.log("audio context creating..."),this.audioContext=new AudioContext,this.bufferSource=null,this.gain=null,this.playOptions=n,console.log("audio context successfully created")}var o=e.prototype;return o.play=function(e){var o=e.file,n=e.onNextLoop,t=new FileReader,i=this;t.onloadend=l((function(){var e,o;return(0,s.__generator)(this,(function(u){switch(u.label){case 0:return null===t.result||"string"===typeof t.result?(console.log("file load failed"),[2]):(console.log("file successfully loaded"),console.log("audio preparing..."),i.bufferSource=i.audioContext.createBufferSource(),i.gain=i.audioContext.createGain(),null===i.bufferSource||null===i.gain?(console.log("bufferSource or gain not initialized (bug?)"),[2]):(i.bufferSource.connect(i.gain),i.gain.connect(i.audioContext.destination),console.log("audio successfully prepared"),console.log("audio decoding..."),[4,i.audioContext.decodeAudioData(t.result)]));case 1:return e=u.sent(),console.log("audio successfully decoded"),console.log("audio play starting..."),i.bufferSource.buffer=e,i.bufferSource.playbackRate.setValueAtTime(i.playOptions.speed,0),i.gain.gain.setValueAtTime(i.playOptions.volume,0),i.bufferSource.start(0),console.log("audio play successfully started"),o=function(){var t=l((function(){return(0,s.__generator)(this,(function(t){return console.log("audio stopped"),i.bufferSource&&i.playOptions.loop&&(console.log("next loop starting..."),i.playOptions.randomizeSpeedEachLoop&&(i.playOptions=c(r({},i.playOptions),{speed:.01*Math.round((1.75*Math.random()+.25)/.01)})),i.bufferSource=i.audioContext.createBufferSource(),i.gain=i.audioContext.createGain(),i.bufferSource.connect(i.gain),i.gain.connect(i.audioContext.destination),i.bufferSource.buffer=e,i.bufferSource.playbackRate.setValueAtTime(i.playOptions.speed,0),i.gain.gain.setValueAtTime(i.playOptions.volume,0),i.bufferSource.start(0),i.bufferSource.onended=o,n({nextPlayOptions:i.playOptions}),console.log("next loop successfully started")),[2]}))}));return function(){return t.apply(this,arguments)}}(),i.bufferSource.onended=o,[2]}}))})),t.readAsArrayBuffer(o),console.log("file read started")},o.stop=function(){this.bufferSource&&(console.log("audio stopping..."),this.bufferSource.onended=null,this.bufferSource.stop(0),console.log("audio successfully stopped"))},o.setPlayOptions=function(e){this.playOptions=e,null!==this.bufferSource&&null!==this.gain&&(this.bufferSource.playbackRate.setValueAtTime(this.playOptions.speed,0),this.gain.gain.setValueAtTime(this.playOptions.volume,0))},e}(),p=function(){var e=function(e){var o=r({},p,e);if(!n)return console.log("audio not initialized (bug?)"),void d(o);n.setPlayOptions(o),d(o)},o=(0,u.useState)(null),n=o[0],t=o[1],a=(0,u.useState)(!1),l=a[0],c=a[1],s=(0,u.useState)({loop:!1,randomizeSpeedEachLoop:!1,speed:1,volume:1}),p=s[0],d=s[1];return(0,u.useEffect)((function(){t(new f({playOptions:p}))}),[]),(0,i.jsx)("div",{style:{backgroundColor:l?"lightyellow":"white",height:"100%",left:0,position:"absolute",top:0,width:"100%"},onDragOver:function(e){e.stopPropagation(),e.preventDefault(),c(!0)},onDrop:function(e){if(console.log("file select detected"),e.stopPropagation(),e.preventDefault(),c(!1),n){var o=e.dataTransfer.files[0];n.stop(),n.play({file:o,onNextLoop:function(e){var o=e.nextPlayOptions;d(o)}})}else console.log("audio not initialized (bug?)")},onDragLeave:function(e){c(!1)},children:(0,i.jsxs)("ul",{children:[(0,i.jsxs)("li",{children:["Volume:",(0,i.jsx)("input",{type:"range",min:"0",max:"2",step:"0.01",value:p.volume,onChange:function(o){e({volume:Number(o.target.value)})}}),p.volume]}),(0,i.jsxs)("li",{children:["Speed:",(0,i.jsx)("input",{type:"range",min:"0.25",max:"2",step:"0.01",value:p.speed.toFixed(2),onChange:function(o){e({speed:Number(o.target.value)})}}),p.speed]}),(0,i.jsxs)("li",{children:["Loop:",(0,i.jsx)("input",{type:"checkbox",checked:p.loop,onChange:function(o){e({loop:o.target.checked})}}),p.loop?"Enabled":"Disabled"]}),p.loop&&(0,i.jsx)("ul",{children:(0,i.jsxs)("li",{children:["Randomize speed:",(0,i.jsx)("input",{type:"checkbox",checked:p.randomizeSpeedEachLoop,onChange:function(o){e({randomizeSpeedEachLoop:o.target.checked})}}),p.randomizeSpeedEachLoop?"Enabled":"Disabled"]})})]})})}}},function(e){e.O(0,[774,888,179],(function(){return o=8312,e(e.s=o);var o}));var o=e.O();_N_E=o}]);